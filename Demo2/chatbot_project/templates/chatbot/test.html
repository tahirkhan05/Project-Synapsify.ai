<!DOCTYPE html>
<html>
<head>
    <title>Ai Model Interface</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'style.css' %}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Ai Model Interface</h1>
        <form id="chatbot-form" method="post" action="{% url 'get_response' %}">
            {% csrf_token %}
            <div class="controls">
                <label for="prompt">Enter Prompt:</label>
                <input type="text" id="prompt" name="prompt">
                <button type="button" id="add-box">Add Chat Box</button>
                <button type="button" id="remove-box">Remove Chat Box</button>
            </div>
            <div id="chat-boxes" class="chat-boxes">
                <div class="chat-box">
                    <label for="audience-1">Enter Audience:</label>
                    <input type="text" id="audience-1" name="audience-1"><br><br>
                    <p>Select AI Model:</p>
                    <input type="radio" id="gemini-1" name="model-1" value="gemini">
                    <label for="gemini-1">Gemini</label><br>
                    <input type="radio" id="gpt-1" name="model-1" value="gpt">
                    <label for="gpt-1">GPT</label><br>
                    <input type="radio" id="groq-1" name="model-1" value="groq">
                    <label for="groq-1">Groq</label><br><br>
                    <div class="output-cell">
                        <h2>Output:</h2>
                        <p class="output"></p>
                    </div>
                </div>
            </div>
            <input type="submit" value="Generate Response">
        </form>
    </div>
    <script>
        $(document).ready(function() {
            let boxCount = 1;

            $('#add-box').click(function() {
                if (boxCount < 4) {
                    boxCount++;
                    $('#chat-boxes').append(
                        `<div class="chat-box">
                            <label for="audience-${boxCount}">Enter Audience:</label>
                            <input type="text" id="audience-${boxCount}" name="audience-${boxCount}"><br><br>
                            <p>Select AI Model:</p>
                            <input type="radio" id="gemini-${boxCount}" name="model-${boxCount}" value="gemini">
                            <label for="gemini-${boxCount}">Gemini</label><br>
                            <input type="radio" id="gpt-${boxCount}" name="model-${boxCount}" value="gpt">
                            <label for="gpt-${boxCount}">GPT</label><br>
                            <input type="radio" id="groq-${boxCount}" name="model-${boxCount}" value="groq">
                            <label for="groq-${boxCount}">Groq</label><br><br>
                            <div class="output-cell">
                                <h2>Output:</h2>
                                <p class="output"></p>
                            </div>
                        </div>`
                    );
                }
            });

            $('#remove-box').click(function() {
                if (boxCount > 1) {
                    $('#chat-boxes .chat-box:last').remove();
                    boxCount--;
                }
            });

            $('#chatbot-form').on('submit', function(event) {
    event.preventDefault();
    $.ajax({
        url: $(this).attr('action'),
        type: $(this).attr('method'),
        data: $(this).serialize(),
        success: function(response) {
            $('.output').each(function(index) {
                const outputText = response['response' + (index + 1)];
                const outputElement = $(this);
                typeOut(outputElement, outputText);
            });
        }
    });
});

function typeOut(element, text) {
    const typingSpeed = 10; // adjust the speed to your liking
    let charIndex = 0;

    function typeChar() {
        if (charIndex < text.length) {
            element.text(element.text() + text[charIndex]);
            charIndex++;
            setTimeout(typeChar, typingSpeed);
        }
    }

    typeChar();
}
        });
    </script>
</body>
</html>